{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\OneDrive\\\\Desktop\\\\Online Book Thrift Store\\\\frontend\\\\src\\\\Components\\\\context\\\\AuthContext\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport { LOGIN_FAILED, LOGIN_SUCCESS } from \"./AuthActionTypes\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const authContext = /*#__PURE__*/createContext();\nconst INITIAL_STATE = {\n  userAuth: JSON.parse(localStorage.getItem('userAuth')),\n  error: null,\n  loading: false,\n  profile: null\n};\nconst reducer = (state, action) => {\n  const {\n    type,\n    payload\n  } = action;\n  switch (type) {\n    //Register\n    case LOGIN_SUCCESS:\n      //Add user to localstorage\n      localStorage.setItem(\"userAuth\", JSON.stringify(payload));\n      return {\n        ...state,\n        loading: false,\n        error: null,\n        userAuth: payload\n      };\n    case LOGIN_FAILED:\n      return {\n        ...state,\n        error: payload,\n        loading: false,\n        userAuth: null\n      };\n    // Profile\n    default:\n      return state;\n  }\n};\nconst AuthContextProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(reducer, INITIAL_STATE);\n  const loginUserAction = async formdata => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    try {\n      var _res$data;\n      const res = await axios.post(\"http://localhost:7000/api/v1/users/login\", formdata, config);\n      if ((res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.status) === \"success\") {\n        dispatch({\n          type: LOGIN_SUCCESS,\n          payload: res.data\n        });\n      }\n      window.location.href = \"/\";\n    } catch (error) {\n      var _error$response, _error$response$data;\n      dispatch({\n        type: LOGIN_FAILED,\n        payload: error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: {\n      loginUserAction\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthContextProvider, \"utWK7j4FjTQK7pks84XMke+2FPM=\");\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useReducer","axios","LOGIN_FAILED","LOGIN_SUCCESS","jsxDEV","_jsxDEV","authContext","INITIAL_STATE","userAuth","JSON","parse","localStorage","getItem","error","loading","profile","reducer","state","action","type","payload","setItem","stringify","AuthContextProvider","children","_s","dispatch","loginUserAction","formdata","config","headers","_res$data","res","post","data","status","window","location","href","_error$response","_error$response$data","response","message","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Admin/OneDrive/Desktop/Online Book Thrift Store/frontend/src/Components/context/AuthContext/AuthContext.js"],"sourcesContent":["import { createContext , useReducer} from \"react\" ; \r\nimport axios from \"axios\";\r\nimport { LOGIN_FAILED, LOGIN_SUCCESS } from \"./AuthActionTypes\";\r\nexport const authContext = createContext() ; \r\n\r\nconst INITIAL_STATE = {\r\n    userAuth: JSON.parse(localStorage.getItem('userAuth')) , \r\n    error: null , \r\n    loading: false , \r\n    profile: null,\r\n}; \r\n\r\nconst reducer = (state, action) => {\r\n    const { type, payload } = action;\r\n    switch (type) {\r\n      //Register\r\n      case LOGIN_SUCCESS:\r\n        //Add user to localstorage\r\n        localStorage.setItem(\"userAuth\", JSON.stringify(payload));\r\n        return {\r\n          ...state,\r\n          loading: false,\r\n          error: null,\r\n          userAuth: payload,\r\n        };\r\n\r\n      case LOGIN_FAILED:\r\n        return {\r\n          ...state,\r\n          error: payload,\r\n          loading: false,\r\n          userAuth: null,\r\n        };\r\n      // Profile\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n\r\n\r\nconst AuthContextProvider = ({children}) => {\r\n    const [ state , dispatch] = useReducer(reducer,INITIAL_STATE); \r\n\r\n    const loginUserAction =  async (formdata) => {\r\n        const config = {\r\n            headers : {\r\n                \"Content-Type\":\"application/json\",\r\n            }\r\n        };\r\n        try {\r\n            const res = await axios.post(\"http://localhost:7000/api/v1/users/login\",formdata,config); \r\n            if(res?.data?.status === \"success\")\r\n            {\r\n                dispatch({\r\n                    type:LOGIN_SUCCESS,\r\n                    payload: res.data,\r\n                })\r\n            }\r\n            window.location.href = \"/\"\r\n        } catch (error) {\r\n            dispatch({\r\n                type:LOGIN_FAILED,\r\n                payload: error?.response?.data?.message,\r\n            })\r\n        }\r\n    }\r\n\r\n    return (\r\n        \r\n        <authContext.Provider value={{loginUserAction}}>\r\n            {children}\r\n        </authContext.Provider>\r\n        \r\n    ); \r\n}; \r\n\r\nexport default AuthContextProvider ; "],"mappings":";;AAAA,SAASA,aAAa,EAAGC,UAAU,QAAO,OAAO;AACjD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,EAAEC,aAAa,QAAQ,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAChE,OAAO,MAAMC,WAAW,gBAAGP,aAAa,CAAC,CAAC;AAE1C,MAAMQ,aAAa,GAAG;EAClBC,QAAQ,EAAEC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAAC;EACtDC,KAAK,EAAE,IAAI;EACXC,OAAO,EAAE,KAAK;EACdC,OAAO,EAAE;AACb,CAAC;AAED,MAAMC,OAAO,GAAGA,CAACC,KAAK,EAAEC,MAAM,KAAK;EAC/B,MAAM;IAAEC,IAAI;IAAEC;EAAQ,CAAC,GAAGF,MAAM;EAChC,QAAQC,IAAI;IACV;IACA,KAAKhB,aAAa;MAChB;MACAQ,YAAY,CAACU,OAAO,CAAC,UAAU,EAAEZ,IAAI,CAACa,SAAS,CAACF,OAAO,CAAC,CAAC;MACzD,OAAO;QACL,GAAGH,KAAK;QACRH,OAAO,EAAE,KAAK;QACdD,KAAK,EAAE,IAAI;QACXL,QAAQ,EAAEY;MACZ,CAAC;IAEH,KAAKlB,YAAY;MACf,OAAO;QACL,GAAGe,KAAK;QACRJ,KAAK,EAAEO,OAAO;QACdN,OAAO,EAAE,KAAK;QACdN,QAAQ,EAAE;MACZ,CAAC;IACH;IACA;MACE,OAAOS,KAAK;EAChB;AACF,CAAC;AAGH,MAAMM,mBAAmB,GAAGA,CAAC;EAACC;AAAQ,CAAC,KAAK;EAAAC,EAAA;EACxC,MAAM,CAAER,KAAK,EAAGS,QAAQ,CAAC,GAAG1B,UAAU,CAACgB,OAAO,EAACT,aAAa,CAAC;EAE7D,MAAMoB,eAAe,GAAI,MAAOC,QAAQ,IAAK;IACzC,MAAMC,MAAM,GAAG;MACXC,OAAO,EAAG;QACN,cAAc,EAAC;MACnB;IACJ,CAAC;IACD,IAAI;MAAA,IAAAC,SAAA;MACA,MAAMC,GAAG,GAAG,MAAM/B,KAAK,CAACgC,IAAI,CAAC,0CAA0C,EAACL,QAAQ,EAACC,MAAM,CAAC;MACxF,IAAG,CAAAG,GAAG,aAAHA,GAAG,wBAAAD,SAAA,GAAHC,GAAG,CAAEE,IAAI,cAAAH,SAAA,uBAATA,SAAA,CAAWI,MAAM,MAAK,SAAS,EAClC;QACIT,QAAQ,CAAC;UACLP,IAAI,EAAChB,aAAa;UAClBiB,OAAO,EAAEY,GAAG,CAACE;QACjB,CAAC,CAAC;MACN;MACAE,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,GAAG;IAC9B,CAAC,CAAC,OAAOzB,KAAK,EAAE;MAAA,IAAA0B,eAAA,EAAAC,oBAAA;MACZd,QAAQ,CAAC;QACLP,IAAI,EAACjB,YAAY;QACjBkB,OAAO,EAAEP,KAAK,aAALA,KAAK,wBAAA0B,eAAA,GAAL1B,KAAK,CAAE4B,QAAQ,cAAAF,eAAA,wBAAAC,oBAAA,GAAfD,eAAA,CAAiBL,IAAI,cAAAM,oBAAA,uBAArBA,oBAAA,CAAuBE;MACpC,CAAC,CAAC;IACN;EACJ,CAAC;EAED,oBAEIrC,OAAA,CAACC,WAAW,CAACqC,QAAQ;IAACC,KAAK,EAAE;MAACjB;IAAe,CAAE;IAAAH,QAAA,EAC1CA;EAAQ;IAAAqB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACS,CAAC;AAG/B,CAAC;AAACvB,EAAA,CAlCIF,mBAAmB;AAAA0B,EAAA,GAAnB1B,mBAAmB;AAoCzB,eAAeA,mBAAmB;AAAE,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}