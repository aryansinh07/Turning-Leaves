{"ast":null,"code":"'use strict';\n\nvar BuildMail = require('buildmail');\nvar libmime = require('libmime');\nmodule.exports = function (mail) {\n  return new MailComposer(mail).compile();\n};\nmodule.exports.MailComposer = MailComposer;\n\n/**\n * Creates the object for composing a BuildMail instance out from the mail options\n *\n * @constructor\n * @param {Object} mail Mail options\n */\nfunction MailComposer(mail) {\n  if (!(this instanceof MailComposer)) {\n    return new MailComposer(mail);\n  }\n  this.mail = mail || {};\n  this.message = false;\n}\n\n/**\n * Builds BuildMail instance\n */\nMailComposer.prototype.compile = function () {\n  this._alternatives = this.getAlternatives();\n  this._htmlNode = this._alternatives.filter(function (alternative) {\n    return /^text\\/html\\b/i.test(alternative.contentType);\n  }).pop();\n  this._attachments = this.getAttachments(!!this._htmlNode);\n  this._useRelated = !!(this._htmlNode && this._attachments.related.length);\n  this._useAlternative = this._alternatives.length > 1;\n  this._useMixed = this._attachments.attached.length > 1 || this._alternatives.length && this._attachments.attached.length === 1;\n\n  // Compose MIME tree\n  if (this.mail.raw) {\n    this.message = new BuildMail().setRaw(this.mail.raw);\n  } else if (this._useMixed) {\n    this.message = this._createMixed();\n  } else if (this._useAlternative) {\n    this.message = this._createAlternative();\n  } else if (this._useRelated) {\n    this.message = this._createRelated();\n  } else {\n    this.message = this._createContentNode(false, [].concat(this._alternatives || []).concat(this._attachments.attached || []).shift() || {\n      contentType: 'text/plain',\n      content: ''\n    });\n  }\n\n  // Add custom headers\n  if (this.mail.headers) {\n    this.message.addHeader(this.mail.headers);\n  }\n\n  // Add headers to the root node, always overrides custom headers\n  ['from', 'sender', 'to', 'cc', 'bcc', 'reply-to', 'in-reply-to', 'references', 'subject', 'message-id', 'date'].forEach(function (header) {\n    var key = header.replace(/-(\\w)/g, function (o, c) {\n      return c.toUpperCase();\n    });\n    if (this.mail[key]) {\n      this.message.setHeader(header, this.mail[key]);\n    }\n  }.bind(this));\n\n  // Sets custom envelope\n  if (this.mail.envelope) {\n    this.message.setEnvelope(this.mail.envelope);\n  }\n\n  // ensure Message-Id value\n  this.message.messageId();\n  return this.message;\n};\n\n/**\n * List all attachments. Resulting attachment objects can be used as input for BuildMail nodes\n *\n * @param {Boolean} findRelated If true separate related attachments from attached ones\n * @returns {Object} An object of arrays (`related` and `attached`)\n */\nMailComposer.prototype.getAttachments = function (findRelated) {\n  var attachments = [].concat(this.mail.attachments || []).map(function (attachment, i) {\n    var data;\n    var isMessageNode = /^message\\//i.test(attachment.contentType);\n    if (/^data:/i.test(attachment.path || attachment.href)) {\n      attachment = this._processDataUrl(attachment);\n    }\n    data = {\n      contentType: attachment.contentType || libmime.detectMimeType(attachment.filename || attachment.path || attachment.href || 'bin'),\n      contentDisposition: attachment.contentDisposition || (isMessageNode ? 'inline' : 'attachment'),\n      contentTransferEncoding: attachment.contentTransferEncoding\n    };\n    if (attachment.filename) {\n      data.filename = attachment.filename;\n    } else if (!isMessageNode && attachment.filename !== false) {\n      data.filename = (attachment.path || attachment.href || '').split('/').pop() || 'attachment-' + (i + 1);\n      if (data.filename.indexOf('.') < 0) {\n        data.filename += '.' + libmime.detectExtension(data.contentType);\n      }\n    }\n    if (/^https?:\\/\\//i.test(attachment.path)) {\n      attachment.href = attachment.path;\n      attachment.path = undefined;\n    }\n    if (attachment.cid) {\n      data.cid = attachment.cid;\n    }\n    if (attachment.raw) {\n      data.raw = attachment.raw;\n    } else if (attachment.path) {\n      data.content = {\n        path: attachment.path\n      };\n    } else if (attachment.href) {\n      data.content = {\n        href: attachment.href\n      };\n    } else {\n      data.content = attachment.content || '';\n    }\n    if (attachment.encoding) {\n      data.encoding = attachment.encoding;\n    }\n    if (attachment.headers) {\n      data.headers = attachment.headers;\n    }\n    return data;\n  }.bind(this));\n  if (!findRelated) {\n    return {\n      attached: attachments,\n      related: []\n    };\n  } else {\n    return {\n      attached: attachments.filter(function (attachment) {\n        return !attachment.cid;\n      }),\n      related: attachments.filter(function (attachment) {\n        return !!attachment.cid;\n      })\n    };\n  }\n};\n\n/**\n * List alternatives. Resulting objects can be used as input for BuildMail nodes\n *\n * @returns {Array} An array of alternative elements. Includes the `text` and `html` values as well\n */\nMailComposer.prototype.getAlternatives = function () {\n  var alternatives = [],\n    text,\n    html,\n    watchHtml,\n    icalEvent;\n  if (this.mail.text) {\n    if (typeof this.mail.text === 'object' && (this.mail.text.content || this.mail.text.path || this.mail.text.href || this.mail.text.raw)) {\n      text = this.mail.text;\n    } else {\n      text = {\n        content: this.mail.text\n      };\n    }\n    text.contentType = 'text/plain' + (!text.encoding && libmime.isPlainText(text.content) ? '' : '; charset=utf-8');\n  }\n  if (this.mail.watchHtml) {\n    if (typeof this.mail.watchHtml === 'object' && (this.mail.watchHtml.content || this.mail.watchHtml.path || this.mail.watchHtml.href || this.mail.watchHtml.raw)) {\n      watchHtml = this.mail.watchHtml;\n    } else {\n      watchHtml = {\n        content: this.mail.watchHtml\n      };\n    }\n    watchHtml.contentType = 'text/watch-html' + (!watchHtml.encoding && libmime.isPlainText(watchHtml.content) ? '' : '; charset=utf-8');\n  }\n  if (this.mail.icalEvent) {\n    if (typeof this.mail.icalEvent === 'object' && (this.mail.icalEvent.content || this.mail.icalEvent.path || this.mail.icalEvent.href || this.mail.icalEvent.raw)) {\n      icalEvent = this.mail.icalEvent;\n    } else {\n      icalEvent = {\n        content: this.mail.icalEvent\n      };\n    }\n    icalEvent.contentType = 'text/calendar; charset=\"utf-8\"; method=' + (icalEvent.method || 'PUBLISH').toString().trim().toUpperCase();\n    if (!icalEvent.headers) {\n      icalEvent.headers = {};\n    }\n    icalEvent.headers['Content-Transfer-Encoding'] = 'base64';\n  }\n  if (this.mail.html) {\n    if (typeof this.mail.html === 'object' && (this.mail.html.content || this.mail.html.path || this.mail.html.href || this.mail.html.raw)) {\n      html = this.mail.html;\n    } else {\n      html = {\n        content: this.mail.html\n      };\n    }\n    html.contentType = 'text/html' + (!html.encoding && libmime.isPlainText(html.content) ? '' : '; charset=utf-8');\n  }\n  [].concat(text || []).concat(watchHtml || []).concat(html || []).concat(icalEvent || []).concat(this.mail.alternatives || []).forEach(function (alternative) {\n    var data;\n    if (/^data:/i.test(alternative.path || alternative.href)) {\n      alternative = this._processDataUrl(alternative);\n    }\n    data = {\n      contentType: alternative.contentType || libmime.detectMimeType(alternative.filename || alternative.path || alternative.href || 'txt'),\n      contentTransferEncoding: alternative.contentTransferEncoding\n    };\n    if (alternative.filename) {\n      data.filename = alternative.filename;\n    }\n    if (/^https?:\\/\\//i.test(alternative.path)) {\n      alternative.href = alternative.path;\n      alternative.path = undefined;\n    }\n    if (alternative.raw) {\n      data.raw = alternative.raw;\n    } else if (alternative.path) {\n      data.content = {\n        path: alternative.path\n      };\n    } else if (alternative.href) {\n      data.content = {\n        href: alternative.href\n      };\n    } else {\n      data.content = alternative.content || '';\n    }\n    if (alternative.encoding) {\n      data.encoding = alternative.encoding;\n    }\n    if (alternative.headers) {\n      data.headers = alternative.headers;\n    }\n    alternatives.push(data);\n  }.bind(this));\n  return alternatives;\n};\n\n/**\n * Builds multipart/mixed node. It should always contain different type of elements on the same level\n * eg. text + attachments\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createMixed = function (parentNode) {\n  var node;\n  if (!parentNode) {\n    node = new BuildMail('multipart/mixed', {\n      baseBoundary: this.mail.baseBoundary,\n      textEncoding: this.mail.textEncoding,\n      boundaryPrefix: this.mail.boundaryPrefix,\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  } else {\n    node = parentNode.createChild('multipart/mixed', {\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  }\n  if (this._useAlternative) {\n    this._createAlternative(node);\n  } else if (this._useRelated) {\n    this._createRelated(node);\n  }\n  [].concat(!this._useAlternative && this._alternatives || []).concat(this._attachments.attached || []).forEach(function (element) {\n    // if the element is a html node from related subpart then ignore it\n    if (!this._useRelated || element !== this._htmlNode) {\n      this._createContentNode(node, element);\n    }\n  }.bind(this));\n  return node;\n};\n\n/**\n * Builds multipart/alternative node. It should always contain same type of elements on the same level\n * eg. text + html view of the same data\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createAlternative = function (parentNode) {\n  var node;\n  if (!parentNode) {\n    node = new BuildMail('multipart/alternative', {\n      baseBoundary: this.mail.baseBoundary,\n      textEncoding: this.mail.textEncoding,\n      boundaryPrefix: this.mail.boundaryPrefix,\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  } else {\n    node = parentNode.createChild('multipart/alternative', {\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  }\n  this._alternatives.forEach(function (alternative) {\n    if (this._useRelated && this._htmlNode === alternative) {\n      this._createRelated(node);\n    } else {\n      this._createContentNode(node, alternative);\n    }\n  }.bind(this));\n  return node;\n};\n\n/**\n * Builds multipart/related node. It should always contain html node with related attachments\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createRelated = function (parentNode) {\n  var node;\n  if (!parentNode) {\n    node = new BuildMail('multipart/related; type=\"text/html\"', {\n      baseBoundary: this.mail.baseBoundary,\n      textEncoding: this.mail.textEncoding,\n      boundaryPrefix: this.mail.boundaryPrefix,\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  } else {\n    node = parentNode.createChild('multipart/related; type=\"text/html\"', {\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  }\n  this._createContentNode(node, this._htmlNode);\n  this._attachments.related.forEach(function (alternative) {\n    this._createContentNode(node, alternative);\n  }.bind(this));\n  return node;\n};\n\n/**\n * Creates a regular node with contents\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @param {Object} element Node data\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createContentNode = function (parentNode, element) {\n  element = element || {};\n  element.content = element.content || '';\n  var node;\n  var encoding = (element.encoding || 'utf8').toString().toLowerCase().replace(/[-_\\s]/g, '');\n  if (!parentNode) {\n    node = new BuildMail(element.contentType, {\n      filename: element.filename,\n      baseBoundary: this.mail.baseBoundary,\n      textEncoding: this.mail.textEncoding,\n      boundaryPrefix: this.mail.boundaryPrefix,\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  } else {\n    node = parentNode.createChild(element.contentType, {\n      filename: element.filename,\n      disableUrlAccess: this.mail.disableUrlAccess,\n      disableFileAccess: this.mail.disableFileAccess\n    });\n  }\n\n  // add custom headers\n  if (element.headers) {\n    node.addHeader(element.headers);\n  }\n  if (element.cid) {\n    node.setHeader('Content-Id', '<' + element.cid.replace(/[<>]/g, '') + '>');\n  }\n  if (element.contentTransferEncoding) {\n    node.setHeader('Content-Transfer-Encoding', element.contentTransferEncoding);\n  } else if (this.mail.encoding && /^text\\//i.test(element.contentType)) {\n    node.setHeader('Content-Transfer-Encoding', this.mail.encoding);\n  }\n  if (!/^text\\//i.test(element.contentType) || element.contentDisposition) {\n    node.setHeader('Content-Disposition', element.contentDisposition || (element.cid ? 'inline' : 'attachment'));\n  }\n  if (typeof element.content === 'string' && ['utf8', 'usascii', 'ascii'].indexOf(encoding) < 0) {\n    element.content = new Buffer(element.content, encoding);\n  }\n\n  // prefer pregenerated raw content\n  if (element.raw) {\n    node.setRaw(element.raw);\n  } else {\n    node.setContent(element.content);\n  }\n  return node;\n};\n\n/**\n * Parses data uri and converts it to a Buffer\n *\n * @param {Object} element Content element\n * @return {Object} Parsed element\n */\nMailComposer.prototype._processDataUrl = function (element) {\n  var parts = (element.path || element.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);\n  if (!parts) {\n    return element;\n  }\n  element.content = /\\bbase64$/i.test(parts[1]) ? new Buffer(parts[2], 'base64') : new Buffer(decodeURIComponent(parts[2]));\n  if ('path' in element) {\n    element.path = false;\n  }\n  if ('href' in element) {\n    element.href = false;\n  }\n  parts[1].split(';').forEach(function (item) {\n    if (/^\\w+\\/[^\\/]+$/i.test(item)) {\n      element.contentType = element.contentType || item.toLowerCase();\n    }\n  });\n  return element;\n};","map":{"version":3,"names":["BuildMail","require","libmime","module","exports","mail","MailComposer","compile","message","prototype","_alternatives","getAlternatives","_htmlNode","filter","alternative","test","contentType","pop","_attachments","getAttachments","_useRelated","related","length","_useAlternative","_useMixed","attached","raw","setRaw","_createMixed","_createAlternative","_createRelated","_createContentNode","concat","shift","content","headers","addHeader","forEach","header","key","replace","o","c","toUpperCase","setHeader","bind","envelope","setEnvelope","messageId","findRelated","attachments","map","attachment","i","data","isMessageNode","path","href","_processDataUrl","detectMimeType","filename","contentDisposition","contentTransferEncoding","split","indexOf","detectExtension","undefined","cid","encoding","alternatives","text","html","watchHtml","icalEvent","isPlainText","method","toString","trim","push","parentNode","node","baseBoundary","textEncoding","boundaryPrefix","disableUrlAccess","disableFileAccess","createChild","element","toLowerCase","Buffer","setContent","parts","match","decodeURIComponent","item"],"sources":["C:/Users/Admin/OneDrive/Desktop/Online Book Thrift Store/frontend/node_modules/mailcomposer/lib/mailcomposer.js"],"sourcesContent":["'use strict';\n\nvar BuildMail = require('buildmail');\nvar libmime = require('libmime');\n\nmodule.exports = function (mail) {\n    return new MailComposer(mail).compile();\n};\n\nmodule.exports.MailComposer = MailComposer;\n\n/**\n * Creates the object for composing a BuildMail instance out from the mail options\n *\n * @constructor\n * @param {Object} mail Mail options\n */\nfunction MailComposer(mail) {\n    if (!(this instanceof MailComposer)) {\n        return new MailComposer(mail);\n    }\n\n    this.mail = mail || {};\n    this.message = false;\n}\n\n/**\n * Builds BuildMail instance\n */\nMailComposer.prototype.compile = function () {\n    this._alternatives = this.getAlternatives();\n    this._htmlNode = this._alternatives.filter(function (alternative) {\n        return /^text\\/html\\b/i.test(alternative.contentType);\n    }).pop();\n    this._attachments = this.getAttachments(!!this._htmlNode);\n\n    this._useRelated = !!(this._htmlNode && this._attachments.related.length);\n    this._useAlternative = this._alternatives.length > 1;\n    this._useMixed = this._attachments.attached.length > 1 || (this._alternatives.length && this._attachments.attached.length === 1);\n\n    // Compose MIME tree\n    if (this.mail.raw) {\n        this.message = new BuildMail().setRaw(this.mail.raw);\n    } else if (this._useMixed) {\n        this.message = this._createMixed();\n    } else if (this._useAlternative) {\n        this.message = this._createAlternative();\n    } else if (this._useRelated) {\n        this.message = this._createRelated();\n    } else {\n        this.message = this._createContentNode(false, [].concat(this._alternatives || []).concat(this._attachments.attached || []).shift() || {\n            contentType: 'text/plain',\n            content: ''\n        });\n    }\n\n    // Add custom headers\n    if (this.mail.headers) {\n        this.message.addHeader(this.mail.headers);\n    }\n\n    // Add headers to the root node, always overrides custom headers\n    [\n        'from',\n        'sender',\n        'to',\n        'cc',\n        'bcc',\n        'reply-to',\n        'in-reply-to',\n        'references',\n        'subject',\n        'message-id',\n        'date'\n    ].forEach(function (header) {\n        var key = header.replace(/-(\\w)/g, function (o, c) {\n            return c.toUpperCase();\n        });\n        if (this.mail[key]) {\n            this.message.setHeader(header, this.mail[key]);\n        }\n    }.bind(this));\n\n    // Sets custom envelope\n    if (this.mail.envelope) {\n        this.message.setEnvelope(this.mail.envelope);\n    }\n\n    // ensure Message-Id value\n    this.message.messageId();\n\n    return this.message;\n};\n\n/**\n * List all attachments. Resulting attachment objects can be used as input for BuildMail nodes\n *\n * @param {Boolean} findRelated If true separate related attachments from attached ones\n * @returns {Object} An object of arrays (`related` and `attached`)\n */\nMailComposer.prototype.getAttachments = function (findRelated) {\n    var attachments = [].concat(this.mail.attachments || []).map(function (attachment, i) {\n        var data;\n        var isMessageNode = /^message\\//i.test(attachment.contentType);\n\n        if (/^data:/i.test(attachment.path || attachment.href)) {\n            attachment = this._processDataUrl(attachment);\n        }\n\n        data = {\n            contentType: attachment.contentType ||\n                libmime.detectMimeType(attachment.filename || attachment.path || attachment.href || 'bin'),\n            contentDisposition: attachment.contentDisposition || (isMessageNode ? 'inline' : 'attachment'),\n            contentTransferEncoding: attachment.contentTransferEncoding\n        };\n\n        if (attachment.filename) {\n            data.filename = attachment.filename;\n        } else if (!isMessageNode && attachment.filename !== false) {\n            data.filename = (attachment.path || attachment.href || '').split('/').pop() || 'attachment-' + (i + 1);\n            if (data.filename.indexOf('.') < 0) {\n                data.filename += '.' + libmime.detectExtension(data.contentType);\n            }\n        }\n\n        if (/^https?:\\/\\//i.test(attachment.path)) {\n            attachment.href = attachment.path;\n            attachment.path = undefined;\n        }\n\n        if (attachment.cid) {\n            data.cid = attachment.cid;\n        }\n\n        if (attachment.raw) {\n            data.raw = attachment.raw;\n        } else if (attachment.path) {\n            data.content = {\n                path: attachment.path\n            };\n        } else if (attachment.href) {\n            data.content = {\n                href: attachment.href\n            };\n        } else {\n            data.content = attachment.content || '';\n        }\n\n        if (attachment.encoding) {\n            data.encoding = attachment.encoding;\n        }\n\n        if (attachment.headers) {\n            data.headers = attachment.headers;\n        }\n\n        return data;\n    }.bind(this));\n\n    if (!findRelated) {\n        return {\n            attached: attachments,\n            related: []\n        };\n    } else {\n        return {\n            attached: attachments.filter(function (attachment) {\n                return !attachment.cid;\n            }),\n            related: attachments.filter(function (attachment) {\n                return !!attachment.cid;\n            })\n        };\n    }\n};\n\n/**\n * List alternatives. Resulting objects can be used as input for BuildMail nodes\n *\n * @returns {Array} An array of alternative elements. Includes the `text` and `html` values as well\n */\nMailComposer.prototype.getAlternatives = function () {\n    var alternatives = [],\n        text, html, watchHtml, icalEvent;\n\n    if (this.mail.text) {\n        if (typeof this.mail.text === 'object' && (this.mail.text.content || this.mail.text.path || this.mail.text.href || this.mail.text.raw)) {\n            text = this.mail.text;\n        } else {\n            text = {\n                content: this.mail.text\n            };\n        }\n        text.contentType = 'text/plain' + (!text.encoding && libmime.isPlainText(text.content) ? '' : '; charset=utf-8');\n    }\n\n    if (this.mail.watchHtml) {\n        if (typeof this.mail.watchHtml === 'object' && (this.mail.watchHtml.content || this.mail.watchHtml.path || this.mail.watchHtml.href || this.mail.watchHtml.raw)) {\n            watchHtml = this.mail.watchHtml;\n        } else {\n            watchHtml = {\n                content: this.mail.watchHtml\n            };\n        }\n        watchHtml.contentType = 'text/watch-html' + (!watchHtml.encoding && libmime.isPlainText(watchHtml.content) ? '' : '; charset=utf-8');\n    }\n\n    if (this.mail.icalEvent) {\n        if (typeof this.mail.icalEvent === 'object' && (this.mail.icalEvent.content || this.mail.icalEvent.path || this.mail.icalEvent.href || this.mail.icalEvent.raw)) {\n            icalEvent = this.mail.icalEvent;\n        } else {\n            icalEvent = {\n                content: this.mail.icalEvent\n            };\n        }\n        icalEvent.contentType = 'text/calendar; charset=\"utf-8\"; method=' + (icalEvent.method || 'PUBLISH').toString().trim().toUpperCase();\n        if (!icalEvent.headers) {\n            icalEvent.headers = {};\n        }\n        icalEvent.headers['Content-Transfer-Encoding'] = 'base64';\n    }\n\n    if (this.mail.html) {\n        if (typeof this.mail.html === 'object' && (this.mail.html.content || this.mail.html.path || this.mail.html.href || this.mail.html.raw)) {\n            html = this.mail.html;\n        } else {\n            html = {\n                content: this.mail.html\n            };\n        }\n        html.contentType = 'text/html' + (!html.encoding && libmime.isPlainText(html.content) ? '' : '; charset=utf-8');\n    }\n\n    [].\n    concat(text || []).\n    concat(watchHtml || []).\n    concat(html || []).\n    concat(icalEvent || []).\n    concat(this.mail.alternatives || []).\n    forEach(function (alternative) {\n        var data;\n\n        if (/^data:/i.test(alternative.path || alternative.href)) {\n            alternative = this._processDataUrl(alternative);\n        }\n\n        data = {\n            contentType: alternative.contentType ||\n                libmime.detectMimeType(alternative.filename || alternative.path || alternative.href || 'txt'),\n            contentTransferEncoding: alternative.contentTransferEncoding\n        };\n\n        if (alternative.filename) {\n            data.filename = alternative.filename;\n        }\n\n        if (/^https?:\\/\\//i.test(alternative.path)) {\n            alternative.href = alternative.path;\n            alternative.path = undefined;\n        }\n\n        if (alternative.raw) {\n            data.raw = alternative.raw;\n        } else if (alternative.path) {\n            data.content = {\n                path: alternative.path\n            };\n        } else if (alternative.href) {\n            data.content = {\n                href: alternative.href\n            };\n        } else {\n            data.content = alternative.content || '';\n        }\n\n        if (alternative.encoding) {\n            data.encoding = alternative.encoding;\n        }\n\n        if (alternative.headers) {\n            data.headers = alternative.headers;\n        }\n\n        alternatives.push(data);\n    }.bind(this));\n\n    return alternatives;\n};\n\n/**\n * Builds multipart/mixed node. It should always contain different type of elements on the same level\n * eg. text + attachments\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createMixed = function (parentNode) {\n    var node;\n\n    if (!parentNode) {\n        node = new BuildMail('multipart/mixed', {\n            baseBoundary: this.mail.baseBoundary,\n            textEncoding: this.mail.textEncoding,\n            boundaryPrefix: this.mail.boundaryPrefix,\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    } else {\n        node = parentNode.createChild('multipart/mixed', {\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    }\n\n    if (this._useAlternative) {\n        this._createAlternative(node);\n    } else if (this._useRelated) {\n        this._createRelated(node);\n    }\n\n    [].concat(!this._useAlternative && this._alternatives || []).concat(this._attachments.attached || []).forEach(function (element) {\n        // if the element is a html node from related subpart then ignore it\n        if (!this._useRelated || element !== this._htmlNode) {\n            this._createContentNode(node, element);\n        }\n    }.bind(this));\n\n    return node;\n};\n\n/**\n * Builds multipart/alternative node. It should always contain same type of elements on the same level\n * eg. text + html view of the same data\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createAlternative = function (parentNode) {\n    var node;\n\n    if (!parentNode) {\n        node = new BuildMail('multipart/alternative', {\n            baseBoundary: this.mail.baseBoundary,\n            textEncoding: this.mail.textEncoding,\n            boundaryPrefix: this.mail.boundaryPrefix,\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    } else {\n        node = parentNode.createChild('multipart/alternative', {\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    }\n\n    this._alternatives.forEach(function (alternative) {\n        if (this._useRelated && this._htmlNode === alternative) {\n            this._createRelated(node);\n        } else {\n            this._createContentNode(node, alternative);\n        }\n    }.bind(this));\n\n    return node;\n};\n\n/**\n * Builds multipart/related node. It should always contain html node with related attachments\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createRelated = function (parentNode) {\n    var node;\n\n    if (!parentNode) {\n        node = new BuildMail('multipart/related; type=\"text/html\"', {\n            baseBoundary: this.mail.baseBoundary,\n            textEncoding: this.mail.textEncoding,\n            boundaryPrefix: this.mail.boundaryPrefix,\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    } else {\n        node = parentNode.createChild('multipart/related; type=\"text/html\"', {\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    }\n\n    this._createContentNode(node, this._htmlNode);\n\n    this._attachments.related.forEach(function (alternative) {\n        this._createContentNode(node, alternative);\n    }.bind(this));\n\n    return node;\n};\n\n/**\n * Creates a regular node with contents\n *\n * @param {Object} parentNode Parent for this note. If it does not exist, a root node is created\n * @param {Object} element Node data\n * @returns {Object} BuildMail node element\n */\nMailComposer.prototype._createContentNode = function (parentNode, element) {\n    element = element || {};\n    element.content = element.content || '';\n\n    var node;\n    var encoding = (element.encoding || 'utf8')\n        .toString()\n        .toLowerCase()\n        .replace(/[-_\\s]/g, '');\n\n    if (!parentNode) {\n        node = new BuildMail(element.contentType, {\n            filename: element.filename,\n            baseBoundary: this.mail.baseBoundary,\n            textEncoding: this.mail.textEncoding,\n            boundaryPrefix: this.mail.boundaryPrefix,\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    } else {\n        node = parentNode.createChild(element.contentType, {\n            filename: element.filename,\n            disableUrlAccess: this.mail.disableUrlAccess,\n            disableFileAccess: this.mail.disableFileAccess\n        });\n    }\n\n    // add custom headers\n    if (element.headers) {\n        node.addHeader(element.headers);\n    }\n\n    if (element.cid) {\n        node.setHeader('Content-Id', '<' + element.cid.replace(/[<>]/g, '') + '>');\n    }\n\n    if (element.contentTransferEncoding) {\n        node.setHeader('Content-Transfer-Encoding', element.contentTransferEncoding);\n    } else if (this.mail.encoding && /^text\\//i.test(element.contentType)) {\n        node.setHeader('Content-Transfer-Encoding', this.mail.encoding);\n    }\n\n    if (!/^text\\//i.test(element.contentType) || element.contentDisposition) {\n        node.setHeader('Content-Disposition', element.contentDisposition || (element.cid ? 'inline' : 'attachment'));\n    }\n\n    if (typeof element.content === 'string' && ['utf8', 'usascii', 'ascii'].indexOf(encoding) < 0) {\n        element.content = new Buffer(element.content, encoding);\n    }\n\n    // prefer pregenerated raw content\n    if (element.raw) {\n        node.setRaw(element.raw);\n    } else {\n        node.setContent(element.content);\n    }\n\n    return node;\n};\n\n/**\n * Parses data uri and converts it to a Buffer\n *\n * @param {Object} element Content element\n * @return {Object} Parsed element\n */\nMailComposer.prototype._processDataUrl = function (element) {\n    var parts = (element.path || element.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);\n    if (!parts) {\n        return element;\n    }\n\n    element.content = /\\bbase64$/i.test(parts[1]) ? new Buffer(parts[2], 'base64') : new Buffer(decodeURIComponent(parts[2]));\n\n    if ('path' in element) {\n        element.path = false;\n    }\n\n    if ('href' in element) {\n        element.href = false;\n    }\n\n    parts[1].split(';').forEach(function (item) {\n        if (/^\\w+\\/[^\\/]+$/i.test(item)) {\n            element.contentType = element.contentType || item.toLowerCase();\n        }\n    });\n\n    return element;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}